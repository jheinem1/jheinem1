<h1 id="getfenv"><a aria-hidden="true" class="anchor-heading" href="#getfenv"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>getfenv</h1>
<pre class="language-lua"><code class="language-Lua"><span class="token function">getfenv</span><span class="token punctuation">(</span>stack<span class="token punctuation">:</span> number <span class="token operator">|</span> <span class="token keyword">function</span><span class="token punctuation">)</span><span class="token punctuation">:</span> table
</code></pre>
<p>Returns the current environment in use by the caller.</p>
<ul>
<li>If provided with a function, the environment of the function will be returned.</li>
<li>If provided with an integer, getfenv will provide the environment of the function at the provided stack level: Level 1 is the function calling getfenv. If stack is 0, getfenv returns the global environment of the current script. When using getfenv to get the current environment of a script, it will return the same table every time within the specific thread.</li>
</ul>
<h2 id="examples"><a aria-hidden="true" class="anchor-heading" href="#examples"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Examples</h2>
<h3 id="getting-current-environment"><a aria-hidden="true" class="anchor-heading" href="#getting-current-environment"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Getting Current Environment</h3>
<pre class="language-lua"><code class="language-Lua">myVariable <span class="token operator">=</span> <span class="token string">"Hello, environments"</span> <span class="token comment">-- Note: a global variable (non-local)</span>
<span class="token keyword">local</span> env <span class="token operator">=</span> <span class="token function">getfenv</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>env<span class="token punctuation">[</span><span class="token string">"myVariable"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">--> Hello, environments</span>
</code></pre>
<h3 id="getting-the-environment-of-a-function"><a aria-hidden="true" class="anchor-heading" href="#getting-the-environment-of-a-function"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Getting the Environment of a Function</h3>
<pre class="language-lua"><code class="language-Lua"><span class="token keyword">function</span> <span class="token function">printMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token keyword">local</span> env <span class="token operator">=</span> <span class="token function">getfenv</span><span class="token punctuation">(</span>printMessage<span class="token punctuation">)</span>
env<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">"Hello, function environments"</span>
<span class="token function">printMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">--> Hello, function environments</span>
</code></pre>
<h3 id="getting-the-environment-of-a-stack"><a aria-hidden="true" class="anchor-heading" href="#getting-the-environment-of-a-stack"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Getting the Environment of a Stack</h3>
<pre class="language-lua"><code class="language-Lua"><span class="token keyword">function</span> <span class="token function">whatIsThePassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">local</span> env <span class="token operator">=</span> <span class="token function">getfenv</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">-- Get the environment 1 level up, or whatever called this function</span>
    <span class="token function">print</span><span class="token punctuation">(</span>env<span class="token punctuation">.</span>password<span class="token punctuation">)</span> <span class="token comment">-- Get the password from the environment one level up</span>
    <span class="token function">print</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span> <span class="token comment">--> nil</span>
<span class="token keyword">end</span>
    
<span class="token keyword">function</span> <span class="token function">openSesame</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">local</span> password <span class="token operator">=</span> <span class="token string">"secret"</span> <span class="token comment">-- A variable local to openSesame</span>
    <span class="token function">whatIsThePassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token function">openSesame</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>